---
import BaseLayout from './BaseLayout.astro';
import ServicePageHero from '../components/ServicePageHero.astro';
import CTABanner from '../components/sections/CTABanner.astro';
import ContactForm from '../components/ui/ContactForm.astro';
import { services } from '../data/services';
import { business } from '../data/business';

interface Props {
  title: string;
  description: string;
  heroTitle: string;
  heroSubtitle: string;
  heroImage?: string;
  currentServiceId: string;
  showReviewsBadge?: boolean;
  reviewsCount?: string;
}

const { title, description, heroTitle, heroSubtitle, heroImage, currentServiceId, showReviewsBadge, reviewsCount } = Astro.props;

const relatedServices = services
  .filter(s => s.id !== currentServiceId && s.slug)
  .slice(0, 3);
---

<BaseLayout title={title} description={description}>
  <ServicePageHero
    title={heroTitle}
    subtitle={heroSubtitle}
    backgroundImage={heroImage}
    showReviewsBadge={showReviewsBadge}
    reviewsCount={reviewsCount}
  />

  <slot />

  <CTABanner />

  <!-- Lead Capture Form Section -->
  <section class="section-padding bg-gray-50">
    <div class="container-custom">
      <div class="max-w-2xl mx-auto">
        <div class="text-center mb-10">
          <h2 class="text-3xl md:text-4xl font-bold text-navy-800 mb-4">
            Request a Free Estimate
          </h2>
          <p class="text-gray-600 text-lg">
            Fill out the form below and we'll get back to you within 24 hours.
          </p>
        </div>
        <ContactForm />
      </div>
    </div>
  </section>

  <!-- Related Services -->
  {relatedServices.length > 0 && (
    <section class="section-padding bg-white">
      <div class="container-custom">
        <h2 class="text-2xl md:text-3xl font-bold text-navy-800 mb-8 text-center">
          Related Services
        </h2>
        <div class="grid md:grid-cols-3 gap-6">
          {relatedServices.map(service => (
            <a
              href={service.slug}
              class="block p-6 bg-gray-50 rounded-xl hover:bg-navy-50 transition-colors group"
            >
              <h3 class="text-xl font-bold text-navy-800 mb-2 group-hover:text-accent transition-colors">
                {service.name}
              </h3>
              <p class="text-gray-600 text-sm">
                {service.description}
              </p>
              <span class="inline-flex items-center text-accent font-semibold mt-3 text-sm">
                Learn More
                <svg class="w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
              </span>
            </a>
          ))}
        </div>
      </div>
    </section>
  )}
</BaseLayout>
